---
- name: Apply SSH + PAM config (all servers)
  hosts: all
  become: yes
  tasks:
    - copy:
        src: scripts/sshd_pam_fix.sh
        dest: /tmp/sshd_pam_fix.sh
        mode: '0755'

    - command: /tmp/sshd_pam_fix.sh

- name: Apply sudoers (AI)
  hosts: ai
  become: yes
  tasks:
    - copy:
        src: scripts/sudoers_setup.sh
        dest: /tmp/sudoers_setup.sh
        mode: '0755'
    - command: /tmp/sudoers_setup.sh ai

- name: Apply sudoers (DevOps)
  hosts: devops
  become: yes
  tasks:
    - command: /tmp/sudoers_setup.sh devops

- name: Apply sudoers (Admin)
  hosts: admin
  become: yes
  tasks:
    - command: /tmp/sudoers_setup.sh admin
